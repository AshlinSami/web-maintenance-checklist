<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Web Maintenance Checklist</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            background-color: #2c5aa0;
            color: white;
            padding: 15px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
            border-radius: 5px;
        }
        .info-section {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
        }
        .info-item {
            display: flex;
            flex-direction: column;
        }
        .info-item label {
            font-weight: bold;
            color: #2c5aa0;
            margin-bottom: 5px;
        }
        .info-item input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .section {
            margin-bottom: 30px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            overflow: hidden;
        }
        .section-header {
            background-color: #4CAF50;
            color: white;
            padding: 12px 15px;
            font-weight: bold;
            font-size: 16px;
        }
        .section-content {
            padding: 15px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .checkbox-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            padding: 5px;
        }
        .checkbox-item input[type="checkbox"] {
            margin-right: 10px;
            transform: scale(1.2);
        }
        .checkbox-item label {
            font-weight: bold;
            margin-right: 10px;
        }
        .checkbox-item input[type="text"], .checkbox-item select {
            margin-left: 10px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
        }
        .plugin-table input[type="text"] {
            width: 100%;
            padding: 5px;
            border: none;
            background: transparent;
        }
        .plugin-table input[type="text"]:focus {
            background-color: #f0f8ff;
            outline: 1px solid #2c5aa0;
        }
        .status-success {
            color: #28a745;
            font-weight: bold;
        }
        .status-issue {
            color: #dc3545;
            font-weight: bold;
        }
        .notes-section {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        .notes-section textarea {
            width: 100%;
            height: 100px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
        }
        .signature-section {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
        }
        @media print {
            body { background-color: white; }
            .container { box-shadow: none; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">WEB MAINTENANCE CHECKLIST</div>
        
        <div class="info-section">
            <div class="info-item">
                <label>Date:</label>
                <input type="date" id="date">
            </div>
            <div class="info-item">
                <label>Specialist:</label>
                <select id="specialist">
                    <option value="">Select specialist</option>
                    <option value="Jason">Jason</option>
                    <option value="Ashlin">Ashlin</option>
                    <option value="Luke">Luke</option>
                </select>
            </div>
            <div class="info-item">
                <label>Website(s):</label>
                <input type="text" placeholder="Enter website URL(s)">
            </div>
        </div>

        <div class="section">
            <div class="section-header">1. BACKUP VERIFICATION</div>
            <div class="section-content">
                <div class="checkbox-item">
                    <input type="checkbox" id="backup-created">
                    <label>Complete backup file created</label>
                </div>
                <div class="checkbox-item">
                    <label>Backup location:</label>
                    <input type="text" placeholder="Enter backup location">
                </div>
                <div class="checkbox-item">
                    <label>Backup size:</label>
                    <input type="text" placeholder="Enter backup size">
                </div>
                <div class="checkbox-item">
                    <label>Backup type:</label>
                    <select>
                        <option>Select type</option>
                        <option>Full</option>
                        <option>Incremental</option>
                        <option>Database Only</option>
                    </select>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="backup-integrity">
                    <label>Backup integrity verified</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="backup-secure">
                    <label>Backup stored securely</label>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">2. PLUGIN MANAGEMENT</div>
            <div class="section-content">
                <h4>Plugins Successfully Updated:</h4>
                <div style="margin-bottom: 10px;">
                    <button type="button" onclick="addSuccessRow()" style="background-color: #28a745; color: white; padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer;">+ Add Plugin Row</button>
                </div>
                <table class="plugin-table" id="success-table">
                    <thead>
                        <tr>
                            <th>Plugin Name</th>
                            <th>Current Version</th>
                            <th>New Version</th>
                            <th>Update Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="x.x.x"></td><td class="status-success">‚úÖ Success</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="x.x.x"></td><td class="status-success">‚úÖ Success</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="x.x.x"></td><td class="status-success">‚úÖ Success</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="x.x.x"></td><td class="status-success">‚úÖ Success</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="x.x.x"></td><td class="status-success">‚úÖ Success</td></tr>
                    </tbody>
                </table>

                <h4>Update Status - Unsuccessful:</h4>
                <div style="margin-bottom: 10px;">
                    <button type="button" onclick="addFailureRow()" style="background-color: #dc3545; color: white; padding: 5px 10px; border: none; border-radius: 3px; cursor: pointer;">+ Add Plugin Row</button>
                </div>
                <table class="plugin-table" id="failure-table">
                    <thead>
                        <tr>
                            <th>Plugin Name</th>
                            <th>Current Version</th>
                            <th>Reason Not Updated</th>
                            <th>Unsuccessful</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td><input type="text" placeholder="Plugin name"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="Reason"></td><td class="status-issue">‚ùå Failed</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="Reason"></td><td class="status-issue">‚ùå Failed</td></tr>
                        <tr><td><input type="text" placeholder="Plugin name"></td><td><input type="text" placeholder="x.x.x"></td><td><input type="text" placeholder="Reason"></td><td class="status-issue">‚ùå Failed</td></tr>
                    </tbody>
                </table>
                
                <p><strong>Common reasons for update failures:</strong> Compatibility issues, Premium plugin requiring manual update, Plugin deprecated, Custom modifications, Client-specific requirements</p>
            </div>
        </div>

        <div class="section">
            <div class="section-header">3. MONDAY TASK VERIFICATION</div>
            <div class="section-content">
                <div class="checkbox-item">
                    <input type="checkbox" id="monday-time">
                    <label>Time logged on Monday</label>
                    <input type="text" placeholder="Hours logged" style="width: 100px;">
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="monday-files">
                    <label>Required files attached on Monday</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="monday-comments">
                    <label>Comments added to Monday task</label>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">4. POST-MAINTENANCE VERIFICATION</div>
            <div class="section-content">
                <div class="checkbox-item">
                    <input type="checkbox" id="homepage-loads">
                    <label>Homepage loads correctly</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="key-pages">
                    <label>Key pages tested</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="contact-forms">
                    <label>Contact forms working</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="search-func">
                    <label>Search functionality working</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="mobile-responsive">
                    <label>Mobile responsiveness verified</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="load-speed">
                    <label>Page load speed acceptable</label>
                </div>
                <div class="checkbox-item">
                    <input type="checkbox" id="no-broken-links">
                    <label>No broken links detected</label>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">5. SECURITY</div>
            <div class="section-content">
                <div class="checkbox-item">
                    <input type="checkbox" id="security-plugin">
                    <label>Security plugin installed</label>
                </div>
            </div>
        </div>

        <div class="section">
            <div class="section-header">6. DOCUMENTATION & REPORTING</div>
            <div class="section-content">
                <div class="checkbox-item">
                    <label>Total plugins updated:</label>
                    <input type="number" id="total-plugins" min="0" style="width: 80px;" readonly>
                    <span style="margin-left: 10px; font-style: italic; color: #666;">(Auto-calculated)</span>
                </div>
            </div>
        </div>

        <div class="notes-section">
            <label><strong>Notes/Additional Comments:</strong></label>
            <textarea placeholder="Enter any additional notes, issues encountered, or important observations..."></textarea>
        </div>

        <div class="signature-section">
            <div class="info-item">
                <label>Completed by:</label>
                <select id="completed-by">
                    <option value="">Select specialist</option>
                    <option value="Jason">Jason</option>
                    <option value="Ashlin">Ashlin</option>
                    <option value="Luke">Luke</option>
                </select>
            </div>
            <div class="info-item">
                <label>Date completed:</label>
                <input type="date" id="date-completed">
            </div>
            <div class="info-item">
                <label>Supervisor review:</label>
                <select id="supervisor-review">
                    <option value="To be reviewed" selected>To be reviewed</option>
                    <option value="Approved">Approved</option>
                    <option value="Needs revision">Needs revision</option>
                </select>
            </div>
        </div>

        <div style="text-align: center; margin: 30px 0; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
            <h3 style="color: #2c5aa0; margin-bottom: 20px;">üìÑ SUBMIT COMPLETED CHECKLIST</h3>
            <button onclick="submitToManagement()" style="background-color: #28a745; color: white; padding: 15px 30px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; font-size: 18px; font-weight: bold;">üìß Submit to Management</button>
            <br><br>
            <p style="color: #666; font-size: 14px; margin-top: 10px;">This will automatically email the completed checklist to management</p>
            <hr style="margin: 20px 0;">
            <button onclick="exportToPDF()" style="background-color: #dc3545; color: white; padding: 12px 24px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; font-size: 16px;">üìã Save as PDF</button>
            <button onclick="exportToEmail()" style="background-color: #17a2b8; color: white; padding: 12px 24px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; font-size: 16px;">üìß Manual Email</button>
            <button onclick="copyToClipboard()" style="background-color: #6c757d; color: white; padding: 12px 24px; border: none; border-radius: 5px; margin: 5px; cursor: pointer; font-size: 16px;">üìã Copy Summary</button>
        </div>
    </div>

    <script>
        // EmailJS Configuration - REPLACE THESE VALUES WITH YOUR ACTUAL EMAILJS DETAILS
        const EMAILJS_PUBLIC_KEY = 'YOUR_PUBLIC_KEY_HERE';
        const EMAILJS_SERVICE_ID = 'service_uug0tal';
        const EMAILJS_TEMPLATE_ID = 'YOUR_TEMPLATE_ID_HERE';
        const MANAGEMENT_EMAIL = 'management@yourcompany.com'; // Replace with actual management email

        // Initialize EmailJS
        (function() {
            emailjs.init(EMAILJS_PUBLIC_KEY);
        })();

        // Set today's date as default
        document.getElementById('date').valueAsDate = new Date();
        
        // Add some interactivity for better UX
        document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                if (this.checked) {
                    this.parentElement.style.backgroundColor = '#e8f5e8';
                } else {
                    this.parentElement.style.backgroundColor = '';
                }
            });
        });

        // Main function to submit to management via EmailJS
        function submitToManagement() {
            // Validate required fields
            const specialist = document.getElementById('specialist').value;
            const website = document.querySelector('input[placeholder="Enter website URL(s)"]').value;
            
            if (!specialist) {
                alert('‚ö†Ô∏è Please select a specialist before submitting.');
                return;
            }
            
            if (!website.trim()) {
                alert('‚ö†Ô∏è Please enter the website URL(s) before submitting.');
                return;
            }

            // Show loading state
            const submitBtn = event.target;
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = 'üì§ Sending...';
            submitBtn.disabled = true;

            // Generate detailed summary for management
            const emailContent = generateManagementSummary();
            
            // Prepare email parameters
            const templateParams = {
                name: specialist,
                time: new Date().toLocaleString(),
                message: emailContent
            };

            // Send email via EmailJS
            emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, templateParams)
                .then(function(response) {
                    console.log('Email sent successfully!', response.status, response.text);
                    
                    // Update completed by and date
                    document.getElementById('completed-by').value = specialist;
                    document.getElementById('date-completed').valueAsDate = new Date();
                    
                    // Success notification
                    submitBtn.innerHTML = '‚úÖ Sent Successfully!';
                    submitBtn.style.backgroundColor = '#28a745';
                    
                    alert('‚úÖ Checklist successfully submitted to management!\n\nüìß Email sent to: ' + MANAGEMENT_EMAIL);
                    
                    // Reset button after 3 seconds
                    setTimeout(() => {
                        submitBtn.innerHTML = originalText;
                        submitBtn.style.backgroundColor = '#28a745';
                        submitBtn.disabled = false;
                    }, 3000);
                    
                }, function(error) {
                    console.error('Failed to send email:', error);
                    
                    // Error notification
                    submitBtn.innerHTML = '‚ùå Failed to Send';
                    submitBtn.style.backgroundColor = '#dc3545';
                    
                    alert('‚ùå Failed to send email to management.\n\nError: ' + error.text + '\n\nPlease use the "Manual Email" option instead.');
                    
                    // Reset button after 3 seconds
                    setTimeout(() => {
                        submitBtn.innerHTML = originalText;
                        submitBtn.style.backgroundColor = '#28a745';
                        submitBtn.disabled = false;
                    }, 3000);
                });
        }

        // Generate comprehensive summary for management email
        function generateManagementSummary() {
            const date = document.querySelector('input[type="date"]').value || 'Not specified';
            const specialist = document.getElementById('specialist').value || 'Not specified';
            const website = document.querySelector('input[placeholder="Enter website URL(s)"]').value || 'Not specified';
            
            let summary = `WEB MAINTENANCE CHECKLIST - COMPLETED\n`;
            summary += `${'='.repeat(50)}\n\n`;
            summary += `üìÖ Date: ${date}\n`;
            summary += `üë§ Specialist: ${specialist}\n`;
            summary += `üåê Website(s): ${website}\n`;
            summary += `‚è∞ Submitted: ${new Date().toLocaleString()}\n\n`;

            // Count completed tasks
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const totalTasks = checkboxes.length;
            const completedTasks = Array.from(checkboxes).filter(cb => cb.checked).length;
            const completionPercent = Math.round(completedTasks/totalTasks*100);
            
            summary += `üìä COMPLETION STATUS: ${completedTasks}/${totalTasks} tasks completed (${completionPercent}%)\n`;
            if (completionPercent === 100) {
                summary += `‚úÖ ALL TASKS COMPLETED SUCCESSFULLY!\n\n`;
            } else {
                summary += `‚ö†Ô∏è  ATTENTION: ${totalTasks - completedTasks} tasks incomplete\n\n`;
            }

            // Backup section
            summary += `üíæ BACKUP VERIFICATION:\n`;
            summary += `   ‚Ä¢ Backup created: ${document.getElementById('backup-created').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Integrity verified: ${document.getElementById('backup-integrity').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Plugin updates
            const successTable = document.getElementById('success-table');
            const failureTable = document.getElementById('failure-table');
            
            let updatedPlugins = [];
            let issuePlugins = [];
            
            // Get successful updates
            const successRows = successTable.querySelectorAll('tbody tr');
            successRows.forEach(row => {
                const inputs = row.querySelectorAll('input[type="text"]');
                const pluginName = inputs[0].value.trim();
                const currentVersion = inputs[1].value.trim();
                const newVersion = inputs[2].value.trim();
                if (pluginName) {
                    updatedPlugins.push(`${pluginName} (${currentVersion} ‚Üí ${newVersion})`);
                }
            });
            
            // Get failed updates
            const failureRows = failureTable.querySelectorAll('tbody tr');
            failureRows.forEach(row => {
                const inputs = row.querySelectorAll('input[type="text"]');
                const pluginName = inputs[0].value.trim();
                const currentVersion = inputs[1].value.trim();
                const reason = inputs[2].value.trim();
                if (pluginName) {
                    issuePlugins.push(`${pluginName} (${currentVersion}) - ${reason}`);
                }
            });

            summary += `üîå PLUGIN UPDATES:\n`;
            summary += `   ‚Ä¢ Successfully updated: ${updatedPlugins.length}\n`;
            if (updatedPlugins.length > 0) {
                updatedPlugins.forEach(plugin => summary += `     - ${plugin}\n`);
            }
            summary += `   ‚Ä¢ Issues/Not updated: ${issuePlugins.length}\n`;
            if (issuePlugins.length > 0) {
                issuePlugins.forEach(plugin => summary += `     - ${plugin}\n`);
            }
            summary += `\n`;

            // Monday tasks
            summary += `üìã MONDAY TASK VERIFICATION:\n`;
            summary += `   ‚Ä¢ Time logged: ${document.getElementById('monday-time').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Files attached: ${document.getElementById('monday-files').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Comments added: ${document.getElementById('monday-comments').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Post-maintenance checks
            summary += `üîç POST-MAINTENANCE VERIFICATION:\n`;
            summary += `   ‚Ä¢ Homepage functional: ${document.getElementById('homepage-loads').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Key pages tested: ${document.getElementById('key-pages').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Contact forms working: ${document.getElementById('contact-forms').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ Mobile responsive: ${document.getElementById('mobile-responsive').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `   ‚Ä¢ No broken links: ${document.getElementById('no-broken-links').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Security
            summary += `üîí SECURITY CHECKS:\n`;
            summary += `   ‚Ä¢ Security plugin installed: ${document.getElementById('security-plugin').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Notes
            const notes = document.querySelector('textarea').value;
            if (notes.trim()) {
                summary += `üìù ADDITIONAL NOTES:\n${notes}\n\n`;
            }

            // Highlight any issues
            const issues = [];
            if (!document.getElementById('backup-created').checked) issues.push('‚ùå Backup not created');
            if (!document.getElementById('backup-integrity').checked) issues.push('‚ùå Backup integrity not verified');
            if (issuePlugins.length > 0) issues.push(`‚ö†Ô∏è  ${issuePlugins.length} plugins failed to update`);
            if (!document.getElementById('security-plugin').checked) issues.push('‚ùå Security plugin not installed');
            
            if (issues.length > 0) {
                summary += `üö® ISSUES REQUIRING ATTENTION:\n`;
                issues.forEach(issue => summary += `   ${issue}\n`);
                summary += `\n`;
            }

            summary += `${'='.repeat(50)}\n`;
            summary += `This automated report was generated by the Web Maintenance Checklist system.\n`;
            summary += `For questions, contact ${specialist}.`;

            return summary;
        }

        // Function to add new rows for successful plugins
        function addSuccessRow() {
            const table = document.getElementById('success-table').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="Plugin name" onchange="updatePluginCount()"></td>
                <td><input type="text" placeholder="x.x.x"></td>
                <td><input type="text" placeholder="x.x.x"></td>
                <td class="status-success">‚úÖ Success</td>
            `;
        }

        // Function to add new rows for failed plugins
        function addFailureRow() {
            const table = document.getElementById('failure-table').getElementsByTagName('tbody')[0];
            const newRow = table.insertRow();
            newRow.innerHTML = `
                <td><input type="text" placeholder="Plugin name"></td>
                <td><input type="text" placeholder="x.x.x"></td>
                <td><input type="text" placeholder="Reason"></td>
                <td class="status-issue">‚ùå Failed</td>
            `;
        }

        // Function to automatically count plugins
        function updatePluginCount() {
            const successTable = document.getElementById('success-table');
            const pluginNameInputs = successTable.querySelectorAll('tbody td:first-child input[type="text"]');
            let count = 0;
            
            pluginNameInputs.forEach(input => {
                if (input.value.trim() !== '') {
                    count++;
                }
            });
            
            document.getElementById('total-plugins').value = count;
        }

        // Initial count calculation
        setTimeout(updatePluginCount, 100);

        // Export functions (existing)
        function exportToPDF() {
            window.print();
            alert('üí° TIP: In the print dialog, select "Save as PDF" as your destination to create a PDF file.');
        }

        function exportToEmail() {
            const summary = generateSummary();
            const subject = encodeURIComponent('Web Maintenance Checklist Completed - ' + new Date().toDateString());
            const body = encodeURIComponent(summary);
            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        }

        function copyToClipboard() {
            const summary = generateSummary();
            navigator.clipboard.writeText(summary).then(() => {
                alert('‚úÖ Checklist summary copied to clipboard! You can now paste it into an email, document, or messaging app.');
            }).catch(() => {
                const textArea = document.createElement('textarea');
                textArea.value = summary;
                document.body.appendChild(textArea);
                textArea.select();
                document.execCommand('copy');
                document.body.removeChild(textArea);
                alert('‚úÖ Checklist summary copied to clipboard!');
            });
        }

        function generateSummary() {
            const date = document.querySelector('input[type="date"]').value || 'Not specified';
            const specialist = document.getElementById('specialist').value || 'Not specified';
            const website = document.querySelector('input[placeholder="Enter website URL(s)"]').value || 'Not specified';
            
            let summary = `WEB MAINTENANCE CHECKLIST SUMMARY\n`;
            summary += `==========================================\n`;
            summary += `Date: ${date}\n`;
            summary += `Specialist: ${specialist}\n`;
            summary += `Website(s): ${website}\n\n`;

            // Count completed tasks
            const checkboxes = document.querySelectorAll('input[type="checkbox"]');
            const totalTasks = checkboxes.length;
            const completedTasks = Array.from(checkboxes).filter(cb => cb.checked).length;
            
            summary += `COMPLETION STATUS: ${completedTasks}/${totalTasks} tasks completed (${Math.round(completedTasks/totalTasks*100)}%)\n\n`;

            // Backup section
            summary += `BACKUP VERIFICATION:\n`;
            summary += `- Backup created: ${document.getElementById('backup-created').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `- Integrity verified: ${document.getElementById('backup-integrity').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Plugin updates
            const successTable = document.getElementById('success-table');
            const failureTable = document.getElementById('failure-table');
            
            let updatedPlugins = [];
            let issuePlugins = [];
            
            // Get successful updates
            const successRows = successTable.querySelectorAll('tbody tr');
            successRows.forEach(row => {
                const inputs = row.querySelectorAll('input[type="text"]');
                const pluginName = inputs[0].value.trim();
                const currentVersion = inputs[1].value.trim();
                const newVersion = inputs[2].value.trim();
                if (pluginName) {
                    updatedPlugins.push(`${pluginName} (${currentVersion} ‚Üí ${newVersion})`);
                }
            });
            
            // Get failed updates
            const failureRows = failureTable.querySelectorAll('tbody tr');
            failureRows.forEach(row => {
                const inputs = row.querySelectorAll('input[type="text"]');
                const pluginName = inputs[0].value.trim();
                const currentVersion = inputs[1].value.trim();
                const reason = inputs[2].value.trim();
                if (pluginName) {
                    issuePlugins.push(`${pluginName} (${currentVersion}) - ${reason}`);
                }
            });

            summary += `PLUGIN UPDATES:\n`;
            summary += `- Successfully updated: ${updatedPlugins.length}\n`;
            if (updatedPlugins.length > 0) {
                updatedPlugins.forEach(plugin => summary += `  ‚Ä¢ ${plugin}\n`);
            }
            summary += `- Issues/Not updated: ${issuePlugins.length}\n`;
            if (issuePlugins.length > 0) {
                issuePlugins.forEach(plugin => summary += `  ‚Ä¢ ${plugin}\n`);
            }
            summary += `\n`;

            // Monday tasks
            summary += `MONDAY TASK VERIFICATION:\n`;
            summary += `- Time logged: ${document.getElementById('monday-time').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `- Files attached: ${document.getElementById('monday-files').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `- Comments added: ${document.getElementById('monday-comments').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Post-maintenance checks
            summary += `POST-MAINTENANCE VERIFICATION:\n`;
            summary += `- Homepage functional: ${document.getElementById('homepage-loads').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `- Mobile responsive: ${document.getElementById('mobile-responsive').checked ? '‚úÖ Yes' : '‚ùå No'}\n`;
            summary += `- No broken links: ${document.getElementById('no-broken-links').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Security
            summary += `SECURITY CHECKS:\n`;
            summary += `- Security plugin installed: ${document.getElementById('security-plugin').checked ? '‚úÖ Yes' : '‚ùå No'}\n\n`;

            // Notes
            const notes = document.querySelector('textarea').value;
            if (notes.trim()) {
                summary += `ADDITIONAL NOTES:\n${notes}\n\n`;
            }

            summary += `==========================================\n`;
            summary += `Completed by: ${document.getElementById('completed-by').value || 'Not specified'}\n`;
            summary += `Date completed: ${document.getElementById('date-completed').value || 'Not specified'}\n`;
            summary += `Generated: ${new Date().toLocaleString()}\n`;

            return summary;
        }
    </script>
</body>
</html>
